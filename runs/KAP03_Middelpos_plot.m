close all;
set(0,'defaultFigureWindowStyle','docked');

if ~exist('S')
    %load([scriptpath,sprintf('/data/Middelpos/Middelpos.mat')]);
    load([scriptpath,sprintf('/data/KAP03/KAP103.mat')]);
    opts.savedir = 'figures/KAP103';
end

opts.savefmt = struct('pdf',0,'png',0);

% Restrict period range in plots
%band = [f(Ic(2)),f(Ic(end))];
%period_range = [1/band(2),1/band(1)]*iopts.info.timedelta;

timeseries_plot(S{1},opts);

opts.type = 'error';
for i = 1:length(S)
    opts.filename = sprintf('timeseries-error_method_%d',i);
    timeseries_plot(S{i},opts);
end
       
spectrum_plot(S1,...
    struct('type','raw','title',[ptitle,'; ',desc1],...
           'period_range',period_range,...
           'filename',[figprfx,'spectrum_1'],'savefmt',savefmt));
spectrum_plot(S2,...
    struct('type','raw','title',[ptitle,'; ',desc1],...
           'period_range',period_range,...
           'filename',[figprfx,'spectrum_2'],'savefmt',savefmt));

sn_plot(S1,...
    struct('title',[ptitle,'; ',desc1],'period_range',period_range,...
           'filename',[figprfx,'SN_1'],'savefmt',savefmt));
sn_plot(S2,...
    struct('title',[ptitle,'; ',desc1],'period_range',period_range,...
           'filename',[figprfx,'SN_2'],'savefmt',savefmt));

filename = [figprfx,'SN'];
if lemi    
    sn_plot({S1,S2,S3},...
        struct('period_range',period_range,'title',ptitle,...
               'filename',filename,'savefmt',savefmt));
else
    sn_plot({S1,S2},...
        struct('period_range',period_range,'title',ptitle,...
               'filename',filename,'savefmt',savefmt));
end

transferfnZ_plot(S1,...
    struct('period_range',period_range,'title',ptitle,...
    'filename',[figprfx,'Z_1'],'savefmt',savefmt));
transferfnZ_plot(S1,...
    struct('period_range',period_range,'title',ptitle,...
    'filename',[figprfx,'Z_2'],'savefmt',savefmt));

filename = [figprfx,'Z'];    
if lemi    
    transferfnZ_plot({S1,S2,S3},...
        struct('period_range',period_range,'title',ptitle,...
               'filename',filename,'savefmt',savefmt));
else
    transferfnZ_plot({S1,S2},...
        struct('period_range',period_range,'title',ptitle,...
               'filename',filename,'savefmt',savefmt));
end
